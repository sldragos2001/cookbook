name: My first Cookbook Workflow
on: [workflow_dispatch]

jobs:
  first_job:
    name: ğŸŒ  My first job
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ© run-commands
        run: |
          echo "Hello ${{ vars.WHO_TO_GREET }} from ${{ github.actor }}."
          echo "Current branch is ${{ github.ref }}. ğŸ‘½ "
          echo "The current directory is `pwd`."
          echo "My secret is ${{ secrets.MY_SECRET }}. ğŸ˜¶"

      - name: ğŸ© Checkout
        uses: actions/checkout@v4.1.0

      - name: ğŸ© run tree
        run: |
          tree
          ls -al

  Test:
    runs-on: ubuntu-latest
    name: ğŸŒ  Test
    environment: Test
    needs: first_job

    steps:
      - name: ğŸ©  test commands
        run: |
          echo "Hello ${{ vars.WHO_TO_GREET }} from ${{ github.actor }}."
          sec=$(echo ${{ secrets.MY_SECRET }} | sed 's/./& /g')
          echo "My secret is '$sec'."

  Load-Test:
    name: ğŸŒ Load-test
    runs-on: ubuntu-latest
    environment: Load-Test
    needs: first_job

    steps:
      - name: ğŸ©  load-test-commands
        run: |
          echo "This is Load Test"
          echo "Hello ${{ vars.WHO_TO_GREET }} from ${{ github.actor }}."
          sec=$(echo ${{ secrets.MY_SECRET }} | sed 's/./& /g')
          echo "My secret is '$sec'." ãŠ™ï¸

  Production:
    runs-on: ubuntu-latest
    environment:
      name: ğŸŒ Production
      url: https://writeabout.net
    needs: [Test, Load-Test]

    steps:
      - name: ğŸ©  production-commands
        run: |
          echo "This is Production"
          echo "Hello ${{ vars.WHO_TO_GREET }} from ${{ github.actor }}."
          echo "WHO AM I  - ${{ vars.WHO_AM_I }} from ${{ github.actor }}."
          echo "ASTA NU E  - ${{ vars.ASTA_NU_E }} from ${{ github.actor }}."
          sec=$(echo ${{ secrets.MY_SECRET }} | sed 's/./& /g')
          echo "My secret is '$sec'. ãŠ™ï¸"
          echo "::debug::This is a debug message."
          echo "::notice::This is a notice message."
          echo "::warning::This is a warning message." ğŸ˜ 
          echo "::error::This is an error message. ğŸ˜±"ğŸ˜± 
      - name: ğŸ« perl-stuff
        shell: perl {0}
        run: |
          say "Hello from perl";

